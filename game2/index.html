<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Dog Adventure - JS Edition</title>
    <style>
        body { margin: 0; background: skyblue; display: flex; justify-content: center; align-items: center; height: 100vh; }
        canvas { border: 1px solid #000; background: skyblue; }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        // Game constants
        const GRAVITY = 0.8;
        const JUMP_STRENGTH = -15;
        const MOVE_SPEED = 5;

        // Player (Happy Dog)
        const dog = {
            x: 50,
            y: 400,
            width: 40,
            height: 40,
            velX: 0,
            velY: 0,
            onGround: false,
            lives: 3
        };

        // Platforms/Blocks
        const platforms = [
            { x: 0, y: 550, width: 800, height: 50, color: 'brown' }, // Ground
            { x: 200, y: 450, width: 60, height: 40, color: 'gray' }, // Block 1
            { x: 400, y: 400, width: 60, height: 40, color: 'gray' }, // Block 2
            { x: 600, y: 450, width: 80, height: 150, color: 'green' } // Pipe
        ];

        // Bats (Enemies)
        let bats = [
            { x: 250, y: 450, width: 30, height: 20, velX: -2 },
            { x: 450, y: 400, width: 30, height: 20, velX: -2 }
        ];

        let score = 0;
        let gameOver = false;

        // Input handling
        const keys = {};
        window.addEventListener('keydown', (e) => { keys[e.code] = true; });
        window.addEventListener('keyup', (e) => { keys[e.code] = false; });

        // Collision detection
        function collides(rect1, rect2) {
            return rect1.x < rect2.x + rect2.width &&
                   rect1.x + rect1.width > rect2.x &&
                   rect1.y < rect2.y + rect2.height &&
                   rect1.y + rect1.height > rect2.y;
        }

        // Update player
        function updateDog() {
            if (gameOver) return;

            // Movement
            dog.velX = 0;
            if (keys['ArrowLeft']) dog.velX = -MOVE_SPEED;
            if (keys['ArrowRight']) dog.velX = MOVE_SPEED;

            // Jump
            if (keys['Space'] && dog.onGround) {
                dog.velY = JUMP_STRENGTH;
                dog.onGround = false;
            }

            // Physics
            dog.velY += GRAVITY;
            dog.x += dog.velX;
            dog.y += dog.velY;

            // Platform collisions
            dog.onGround = false;
            for (let plat of platforms) {
                if (collides(dog, plat)) {
                    if (dog.velY > 0 && dog.y < plat.y) { // Landing
                        dog.y = plat.y - dog.height;
                        dog.velY = 0;
                        dog.onGround = true;
                    } else if (dog.velY < 0 && dog.y > plat.y) { // Head bump
                        dog.y = plat.y + plat.height;
                        dog.velY = 0;
                    }
                    if (dog.velX > 0) dog.x = plat.x - dog.width;
                    if (dog.velX < 0) dog.x = plat.x + plat.width;
                }
            }

            // Ground boundary
            if (dog.y > 550 - dog.height) {
                dog.y = 550 - dog.height;
                dog.velY = 0;
                dog.onGround = true;
            }

            // Screen bounds
            dog.x = Math.max(0, Math.min(760, dog.x));

            // Bat collisions
            for (let i = bats.length - 1; i >= 0; i--) {
                let bat = bats[i];
                if (collides(dog, bat)) {
                    if (dog.velY > 0 && dog.y < bat.y) { // Stomp
                        bats.splice(i, 1);
                        dog.velY = JUMP_STRENGTH / 2;
                        score += 10;
                    } else { // Hit
                        dog.lives--;
                        dog.x = 50;
                        dog.y = 400;
                        dog.velX = 0;
                        dog.velY = 0;
                        if (dog.lives <= 0) gameOver = true;
                    }
                }
            }
        }

        // Update bats
        function updateBats() {
            for (let bat of bats) {
                bat.x += bat.velX;
                if (bat.x <= 0 || bat.x >= 770 - bat.width) {
                    bat.velX *= -1;
                }
            }
        }

        // Draw functions
        function drawDog() {
            ctx.fillStyle = 'yellow';
            ctx.fillRect(dog.x, dog.y, dog.width, dog.height);
            // Simple face
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(dog.x + 10, dog.y + 15, 3, 0, Math.PI * 2); // Left eye
            ctx.arc(dog.x + 30, dog.y + 15, 3, 0, Math.PI * 2); // Right eye
            ctx.arc(dog.x + 20, dog.y + 30, 5, 0, Math.PI); // Smile
            ctx.fill();
        }

        function drawPlatform(plat) {
            ctx.fillStyle = plat.color;
            ctx.fillRect(plat.x, plat.y, plat.width, plat.height);
        }

        function drawBat(bat) {
            ctx.fillStyle = 'red';
            ctx.fillRect(bat.x, bat.y, bat.width, bat.height);
            // Simple wings
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.moveTo(bat.x, bat.y);
            ctx.lineTo(bat.x - 10, bat.y + 10);
            ctx.lineTo(bat.x, bat.y + 20);
            ctx.fill();
            ctx.beginPath();
            ctx.moveTo(bat.x + bat.width, bat.y);
            ctx.lineTo(bat.x + bat.width + 10, bat.y + 10);
            ctx.lineTo(bat.x + bat.width, bat.y + 20);
            ctx.fill();
        }

        function drawUI() {
            ctx.fillStyle = 'black';
            ctx.font = '20px Arial';
            ctx.fillText(`Score: ${score} | Lives: ${dog.lives}`, 10, 30);
            if (gameOver) {
                ctx.fillStyle = 'rgba(0,0,0,0.5)';
                ctx.fillRect(0, 0, 800, 600);
                ctx.fillStyle = 'white';
                ctx.font = '40px Arial';
                ctx.fillText('Game Over!', 300, 300);
                ctx.font = '20px Arial';
                ctx.fillText(`Final Score: ${score}`, 320, 340);
                ctx.fillText('Refresh to play again', 280, 370);
            }
            if (bats.length === 0 && !gameOver) {
                ctx.fillStyle = 'rgba(0,255,0,0.5)';
                ctx.fillRect(0, 0, 800, 600);
                ctx.fillStyle = 'white';
                ctx.font = '40px Arial';
                ctx.fillText('You Win!', 320, 300);
                ctx.font = '20px Arial';
                ctx.fillText(`Score: ${score}`, 340, 340);
            }
        }

        // Main game loop
        function gameLoop() {
            ctx.clearRect(0, 0, 800, 600);

            // Draw background (sky)
            ctx.fillStyle = 'skyblue';
            ctx.fillRect(0, 0, 800, 600);

            updateDog();
            updateBats();

            platforms.forEach(drawPlatform);
            bats.forEach(drawBat);
            drawDog();
            drawUI();

            requestAnimationFrame(gameLoop);
        }

        gameLoop();
    </script>
</body>
</html>
